ZEX_MAREGYPT_REPUBLICAN_AGITATION_CATEGORY = {
	ZEX_MGY_UNREST_INTERVAL = { #Republican agitation - every set of days, unrest rises
		days_mission_timeout = ZEX_MGY_UNREST_EFFECTS_INTERVALLS

		priority = 1000

		fixed_random_seed = no

		activation = {
			has_country_flag = zex_has_republican_agitation
		}

		available = {
			NOT = {
				has_idea = ZEX_Unfinished_Constitution
			}
		}

		is_good = no

		remove_effect = {
			
		}

		timeout_effect = {
			if = {
				limit = {
					NOT = {
						has_country_flag = ZEX_MGY_LIMIT_UNREST_TARGETS
					}
				}
				custom_effect_tooltip = zex_mgy_unrest_increase_in_provinces_tt
			}
			else = {
				custom_effect_tooltip = zex_mgy_unrest_increase_in_province_tt
			}
			hidden_effect = {
				ZEX_MGY_Increase_Unrest = yes

				#Remove Protection Status
				clr_country_flag = ZEX_MGY_Sineighi_protected_flag
				clr_country_flag = ZEX_MGY_Maneisrata_protected_flag
				clr_country_flag = ZEX_MGY_Kaneigh_protected_flag
				clr_country_flag = ZEX_MGY_Delta_protected_flag
				clr_country_flag = ZEX_MGY_Manephis_protected_flag
				clr_country_flag = ZEX_MGY_Somnambula_protected_flag
				clr_country_flag = ZEX_MGY_Desert_protected_flag
				clr_country_flag = ZEX_MGY_Zush_protected_flag
				clr_country_flag = ZEX_MGY_UpperMaregypt_protected_flag

				#Reset decisions
				set_variable = {
					ZEX_MGY_Actions_Taken = 0
				}
				
				clr_country_flag = ZEX_MGY_Royal_Concessions
				clr_country_flag = ZEX_MGY_Increased_Legitimacy

				activate_mission = ZEX_MGY_UNREST_INTERVAL
			}
		}
	}

	# Increase Legitimacy / Concessions

	ZEX_MGY_unrest_increase_legitimacy = {
		icon = ZEX_GFX_increase_legitimacy
		cost = 50

		priority = 900

		available = {
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_ONLY_ONCE_PER_MOVE
				NOT = {
					has_country_flag = ZEX_MGY_Increased_Legitimacy
				}
			}
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_TWO_ACTIONS_AT_MOST_PER_MOVE
				check_variable = {
					ZEX_MGY_Actions_Taken < 2
				}
			}
		}

		complete_effect = {
			custom_effect_tooltip = ZEX_MGY_INCREASE_LEGITIMACY_10
			hidden_effect = {
				set_country_flag = ZEX_MGY_Increased_Legitimacy
				add_to_variable = {
					var = ZEX_MGY_Actions_Taken
					value = 1
				}
				add_to_variable = {
					var = ZEX_MGY_LEGITIMACY
					value = 10
				}
				clamp_variable = {
					var = ZEX_MGY_LEGITIMACY
					max = 100
				}
			}
		}
	}

	ZEX_MGY_unrest_political_concessions = {
		icon = ZEX_GFX_Royal_Concessions

		custom_cost_trigger = {
			check_variable = {
				ZEX_MGY_LEGITIMACY > 15
			}
		}
		custom_cost_text = ZEX_MGY_LEGITIMACY_15

		priority = 900

		available = {
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_ONLY_ONCE_PER_MOVE
				NOT = {
					has_country_flag = ZEX_MGY_Royal_Concessions
				}
			}
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_TWO_ACTIONS_AT_MOST_PER_MOVE
				check_variable = {
					ZEX_MGY_Actions_Taken < 2
				}
			}
		}

		complete_effect = {
			custom_effect_tooltip = ZEX_MGY_Decrease_Unrest_Everywhere
			custom_effect_tooltip = ZEX_MGY_COST_15_LEGITIMACY
			hidden_effect = {
				set_country_flag = ZEX_MGY_Royal_Concessions
				add_to_variable = {
					var = ZEX_MGY_Actions_Taken
					value = 1
				}
				add_to_variable = {
					var = ZEX_MGY_LEGITIMACY
					value = -15
				}
				clamp_variable = {
					var = ZEX_MGY_LEGITIMACY
					min = 0
				}
				subtract_from_variable = {
					var = ZEX_MGY_VAR_Zush_Alignment
					value = 3
				}
				clamp_variable = {
					var = ZEX_MGY_VAR_Zush_Alignment
					min = 0
				}
				subtract_from_variable = {
					var = ZEX_MGY_VAR_Kaneigh_Alignment
					value = 3
				}
				clamp_variable = {
					var = ZEX_MGY_VAR_Kaneigh_Alignment
					min = 0
				}
				subtract_from_variable = {
					var = ZEX_MGY_VAR_Sineighi_Alignment
					value = 3
				}
				clamp_variable = {
					var = ZEX_MGY_VAR_Sineighi_Alignment
					min = 0
				}
				subtract_from_variable = {
					var = ZEX_MGY_VAR_Somnambula_Alignment
					value = 3
				}
				clamp_variable = {
					var = ZEX_MGY_VAR_Somnambula_Alignment
					min = 0
				}
				subtract_from_variable = {
					var = ZEX_MGY_VAR_Delta_Alignment
					value = 3
				}
				clamp_variable = {
					var = ZEX_MGY_VAR_Delta_Alignment
					min = 0
				}
				subtract_from_variable = {
					var = ZEX_MGY_VAR_UpperMaregypt_Alignment
					value = 3
				}
				clamp_variable = {
					var = ZEX_MGY_VAR_UpperMaregypt_Alignment
					min = 0
				}
				subtract_from_variable = {
					var = ZEX_MGY_VAR_Manephis_Alignment
					value = 3
				}
				clamp_variable = {
					var = ZEX_MGY_VAR_Manephis_Alignment
					min = 0
				}
				subtract_from_variable = {
					var = ZEX_MGY_VAR_UpperMaregypt_Alignment
					value = 3
				}
				clamp_variable = {
					var = ZEX_MGY_VAR_UpperMaregypt_Alignment
					min = 0
				}
				subtract_from_variable = {
					var = ZEX_MGY_VAR_Maneisrata_Alignment
					value = 3
				}
				clamp_variable = {
					var = ZEX_MGY_VAR_Maneisrata_Alignment
					min = 0
				}
				ZEX_MGY_GET_AVERAGE_UNREST = yes
			}
		}
	}

	#Protection Decisions

	ZEX_MGY_Protect_Delta = {
		icon = GFX_decision_eng_trade_unions_demand
		cost = ZEX_MGY_UNREST_COUNTER_COST

		available = {
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_ONLY_ONCE_PER_MOVE
				NOT = {
					has_country_flag = ZEX_MGY_Delta_protected_flag
				}
			}
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_TWO_ACTIONS_AT_MOST_PER_MOVE
				check_variable = {
					ZEX_MGY_Actions_Taken < 2
				}
			}
		}

		complete_effect = {
			custom_effect_tooltip = ZEX_MGY_PROVINCE_PROTECTED_THIS_ROUND_tt
			hidden_effect = {
				set_country_flag = ZEX_MGY_Delta_protected_flag
				add_to_variable = {
					var = ZEX_MGY_Actions_Taken
					value = 1
				}
			}
		}
	}

	ZEX_MGY_Protect_Sineighi = {
		icon = GFX_decision_eng_trade_unions_demand
		cost = ZEX_MGY_UNREST_COUNTER_COST

		available = {
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_ONLY_ONCE_PER_MOVE
				NOT = {
					has_country_flag = ZEX_MGY_Sineighi_protected_flag
				}
			}
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_TWO_ACTIONS_AT_MOST_PER_MOVE
				check_variable = {
					ZEX_MGY_Actions_Taken < 2
				}
			}
		}

		complete_effect = {
			custom_effect_tooltip = ZEX_MGY_PROVINCE_PROTECTED_THIS_ROUND_tt
			hidden_effect = {
				set_country_flag = ZEX_MGY_Sineighi_protected_flag
				add_to_variable = {
					var = ZEX_MGY_Actions_Taken
					value = 1
				}
			}
		}
	}

	ZEX_MGY_Protect_Kaneigh = {
		icon = GFX_decision_eng_trade_unions_demand
		cost = ZEX_MGY_UNREST_COUNTER_COST

		available = {
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_ONLY_ONCE_PER_MOVE
				NOT = {
					has_country_flag = ZEX_MGY_Kaneigh_protected_flag
				}
			}
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_TWO_ACTIONS_AT_MOST_PER_MOVE
				check_variable = {
					ZEX_MGY_Actions_Taken < 2
				}
			}
		}

		complete_effect = {
			custom_effect_tooltip = ZEX_MGY_PROVINCE_PROTECTED_THIS_ROUND_tt
			hidden_effect = {
				set_country_flag = ZEX_MGY_Kaneigh_protected_flag
				add_to_variable = {
					var = ZEX_MGY_Actions_Taken
					value = 1
				}
			}
		}
	}

	ZEX_MGY_Protect_Manephis = {
		icon = GFX_decision_eng_trade_unions_demand
		cost = ZEX_MGY_UNREST_COUNTER_COST

		available = {
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_ONLY_ONCE_PER_MOVE
				NOT = {
					has_country_flag = ZEX_MGY_Manephis_protected_flag
				}
			}
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_TWO_ACTIONS_AT_MOST_PER_MOVE
				check_variable = {
					ZEX_MGY_Actions_Taken < 2
				}
			}
		}

		complete_effect = {
			custom_effect_tooltip = ZEX_MGY_PROVINCE_PROTECTED_THIS_ROUND_tt
			hidden_effect = {
				set_country_flag = ZEX_MGY_Manephis_protected_flag
				add_to_variable = {
					var = ZEX_MGY_Actions_Taken
					value = 1
				}
			}
		}
	}

	ZEX_MGY_Protect_Maneisrata = {
		icon = GFX_decision_eng_trade_unions_demand
		cost = ZEX_MGY_UNREST_COUNTER_COST

		available = {
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_ONLY_ONCE_PER_MOVE
				NOT = {
					has_country_flag = ZEX_MGY_Maneisrata_protected_flag
				}
			}
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_TWO_ACTIONS_AT_MOST_PER_MOVE
				check_variable = {
					ZEX_MGY_Actions_Taken < 2
				}
			}
		}

		complete_effect = {
			custom_effect_tooltip = ZEX_MGY_PROVINCE_PROTECTED_THIS_ROUND_tt
			hidden_effect = {
				set_country_flag = ZEX_MGY_Maneisrata_protected_flag
				add_to_variable = {
					var = ZEX_MGY_Actions_Taken
					value = 1
				}
			}
		}
	}

	ZEX_MGY_Protect_Somnambula = {
		icon = GFX_decision_eng_trade_unions_demand
		cost = ZEX_MGY_UNREST_COUNTER_COST

		available = {
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_ONLY_ONCE_PER_MOVE
				NOT = {
					has_country_flag = ZEX_MGY_Somnambula_protected_flag
				}
			}
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_TWO_ACTIONS_AT_MOST_PER_MOVE
				check_variable = {
					ZEX_MGY_Actions_Taken < 2
				}
			}
		}

		complete_effect = {
			custom_effect_tooltip = ZEX_MGY_PROVINCE_PROTECTED_THIS_ROUND_tt
			hidden_effect = {
				set_country_flag = ZEX_MGY_Somnambula_protected_flag
				add_to_variable = {
					var = ZEX_MGY_Actions_Taken
					value = 1
				}
			}
		}
	}

	ZEX_MGY_Protect_Desert = {
		icon = GFX_decision_eng_trade_unions_demand
		cost = ZEX_MGY_UNREST_COUNTER_COST

		available = {
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_ONLY_ONCE_PER_MOVE
				NOT = {
					has_country_flag = ZEX_MGY_Desert_protected_flag
				}
			}
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_TWO_ACTIONS_AT_MOST_PER_MOVE
				check_variable = {
					ZEX_MGY_Actions_Taken < 2
				}
			}
		}

		complete_effect = {
			custom_effect_tooltip = ZEX_MGY_PROVINCE_PROTECTED_THIS_ROUND_tt
			hidden_effect = {
				set_country_flag = ZEX_MGY_Desert_protected_flag
				add_to_variable = {
					var = ZEX_MGY_Actions_Taken
					value = 1
				}
			}
		}
	}

	ZEX_MGY_Protect_UpperMaregypt = {
		icon = GFX_decision_eng_trade_unions_demand
		cost = ZEX_MGY_UNREST_COUNTER_COST

		available = {
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_ONLY_ONCE_PER_MOVE
				NOT = {
					has_country_flag = ZEX_MGY_UpperMaregypt_protected_flag
				}
			}
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_TWO_ACTIONS_AT_MOST_PER_MOVE
				check_variable = {
					ZEX_MGY_Actions_Taken < 2
				}
			}
		}

		complete_effect = {
			custom_effect_tooltip = ZEX_MGY_PROVINCE_PROTECTED_THIS_ROUND_tt
			hidden_effect = {
				set_country_flag = ZEX_MGY_UpperMaregypt_protected_flag
				add_to_variable = {
					var = ZEX_MGY_Actions_Taken
					value = 1
				}
			}
		}
	}

	ZEX_MGY_Protect_Zush = {
		icon = GFX_decision_eng_trade_unions_demand
		cost = ZEX_MGY_UNREST_COUNTER_COST

		available = {
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_ONLY_ONCE_PER_MOVE
				NOT = {
					has_country_flag = ZEX_MGY_Zush_protected_flag
				}
			}
			custom_trigger_tooltip = {
				tooltip = ZEX_MGY_TWO_ACTIONS_AT_MOST_PER_MOVE
				check_variable = {
					ZEX_MGY_Actions_Taken < 2
				}
			}
		}

		complete_effect = {
			custom_effect_tooltip = ZEX_MGY_PROVINCE_PROTECTED_THIS_ROUND_tt
			hidden_effect = {
				set_country_flag = ZEX_MGY_Zush_protected_flag
				add_to_variable = {
					var = ZEX_MGY_Actions_Taken
					value = 1
				}
			}
		}
	}

	#Debug
	ZEX_MGY_DEBUG_Toggle_Sineighi_State = {
		visible = {
			is_debug = yes
		}

		days_remove = 3

		complete_effect = {
			set_country_flag = ZEX_MGY_Sineighi_protected_flag
		}
	
		remove_effect = {
			clr_country_flag = ZEX_MGY_Sineighi_protected_flag
		}
	}
}